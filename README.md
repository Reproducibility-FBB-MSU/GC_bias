# Codon-bias
This project is aimed to reproduce some plots from [Palidwor GA, Perkins TJ, Xia X (2010) A General Model of Codon Bias Due to GC Mutational Bias. PLoS ONE 5(10): e13431.](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0013431#abstract0)

В статье построена математическая модель, объясняющая разную зависимость кодонного биаса (использование одного из синонимичных кодонов) от общего GC состава генома. На основе этой модели были получены предполагаемые функции зависимости кодонного состава от GC3. Графики этих зависимостей были наложены на скаттерплот реальных зависимостей во множестве геномов. Кроме того, были построены теплокарты, отображающие корреляции GС3 и абсолютные/относительные (посчитанные внутри группы синонимичных кодонов) частоты кодонов. 

Мы воспроизводим рисунки 1, 4, 5, 6, 7. При этом скаттерплоты с рисунка 1 были построены только по данным бактериальных и хлоропластных геномов, в статье были также использованы данные по генам человека. В статье полученные реальные аппроксимированные зависимости приводятся только в виде рисунков, поэтому мы не могли сравнить полученные нами рисунки и рисунки из статьи численно, но визуально рисунки похожи.

Часть 1: подготовка данных.
В файле dataset.ipynb создаются таблицы df_proc_relfreq.csv и df_plant_relfreq.csv, содержащие относительные частоты синонимичных кодонов и df_proc.csv + df_plant.csv, содержащие абсолютные частоты синонимичных кодонов и использующиеся потом для построения всех графиков. 
В файле rel_freq.ipynb находится одноименная функция, по "сырым" данным из базы данных CCUG (те же данные, что использовались в статье) считающая частоты синонимичных кодонов.

Часть 2: построение теплокарт.
В файле heatmaker.ipynb строятся теплокарты корреляции между G/C составом и GC3 для каждого динуклеотида для бактерий и растений (соответствуют теплокартам с рисунка 1 в статье).

Часть 3: построение скаттерплотов.
В файле model_definer.ipynb содержится единственная функция y_model(codon), по кодону определяющая, какая теоретически у него должна быть зависимость относительной частоты (внутри группы синонимичных) от GC (соответственно мат. модели из статьи). Функция возвращает вектор из значений функции предполагаемой зависимости.
В файле loess_1d.py находится одноименная функция, аппроксимирующая точки на скаттерплоте (возвращает вектор из значений). Это стандартная аппроксимация, файл с кодом был взят из [источника](https://pypi.org/project/loess/).

В файлах one_codon_graph.ipynb, plant_proc_graph.ipynb, two-three_codons_grafics_without_sum.ipynb, two_three_sum_graph.ipynb строятся сами скаттерплоты. На каждом рисунке накладываются друг на друга три слоя:
(1) сам скаттерплот из точек (каждая точка соответствует одному геному с определёнными значениями относительной частоты используемости конкретного кодона среди синонимичных и GC3);
(2) loess-аппроксимация (жирная линия того же цвета, что и точки);
(3) зависимость относительной доли от GC3, согласно мат.модели, построенной в статье (красная линия).



